<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ToonCloud+ TV</title>
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;800&display=swap');

        :root {
            --bg-color: #0f1014;
            --glass-bg: rgba(255, 255, 255, 0.05);
            --glass-border: rgba(255, 255, 255, 0.08);
            --accent: #ff2a75;
            --accent-hover: #ff0055;
            --accent-glow: rgba(255, 42, 117, 0.5);
            --text-main: #ffffff;
            --text-sec: #b3b3b3;
            --rating-color: #ffd700;
        }

        body {
            margin: 0; background-color: var(--bg-color); color: var(--text-main);
            font-family: 'Poppins', sans-serif; overflow-x: hidden;
            scroll-behavior: smooth;
        }

        /* --- SCROLLBAR --- */
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: rgba(255, 255, 255, 0.2); border-radius: 10px; transition: 0.3s; }
        ::-webkit-scrollbar-thumb:hover { background: var(--accent); }

        /* --- ANIMACIONES --- */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes fadeInModal {
            from { opacity: 0; transform: scale(0.95); backdrop-filter: blur(0px); }
            to { opacity: 1; transform: scale(1); backdrop-filter: blur(15px); }
        }

        /* --- NAVBAR --- */
        nav {
            display: flex; justify-content: space-between; align-items: center;
            padding: 20px 40px; position: absolute; top: 0; width: 100%; z-index: 10; box-sizing: border-box;
            flex-wrap: wrap; gap: 15px;
            background: linear-gradient(to bottom, rgba(15, 16, 20, 0.95), transparent);
        }
        .logo-container img { 
            height: 40px; 
            filter: drop-shadow(0 0 12px var(--accent-glow)); 
            cursor: pointer; 
            transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .logo-container img:hover { transform: scale(1.08) rotate(-2deg); }

        .nav-right { display: flex; gap: 15px; align-items: center; width: 100%; justify-content: space-between; }
        
        .search-input, .lang-select {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            padding: 10px 18px;
            border-radius: 25px;
            color: white;
            outline: none;
            backdrop-filter: blur(12px);
            transition: all 0.3s ease;
            font-family: 'Poppins', sans-serif;
        }
        .search-input { flex-grow: 1; font-size: 14px; max-width: 300px; }
        .search-input:focus { border-color: var(--accent); background: rgba(255, 255, 255, 0.1); box-shadow: 0 0 15px var(--accent-glow); max-width: 400px; }
        .lang-select { cursor: pointer; }

        /* --- CONTADOR DE USUARIOS --- */
        .user-counter {
            display: flex; align-items: center; gap: 8px;
            background: rgba(255, 42, 117, 0.1);
            padding: 8px 18px; border-radius: 25px;
            border: 1px solid rgba(255, 42, 117, 0.3);
            font-size: 13px; font-weight: 600; color: var(--accent);
            backdrop-filter: blur(5px);
        }
        .planet { font-size: 16px; animation: spin 4s linear infinite; display: inline-block; }
        @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

        /* --- AUTH & PROFILE --- */
        .auth-container { display: flex; align-items: center; gap: 10px; }
        .nav-avatar { width: 42px; height: 42px; border-radius: 50%; border: 2px solid var(--accent); cursor: pointer; object-fit: cover; transition: 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        .nav-avatar:hover { transform: scale(1.15); box-shadow: 0 0 15px var(--accent-glow); }
        
        .profile-modal {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.8); z-index: 300; justify-content: center; align-items: center;
        }
        .profile-card {
            background: #15161c; padding: 40px; border-radius: 24px; width: 90%; max-width: 380px;
            border: 1px solid var(--glass-border); text-align: center; position: relative;
            animation: fadeInModal 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 25px 50px rgba(0,0,0,0.6);
        }
        .profile-card img { width: 100px; height: 100px; border-radius: 50%; border: 3px solid var(--accent); margin-bottom: 20px; object-fit: cover; box-shadow: 0 0 20px var(--accent-glow); }
        .profile-input {
            width: 100%; padding: 14px; margin-bottom: 15px; border-radius: 12px;
            border: 1px solid var(--glass-border); background: var(--glass-bg);
            color: white; outline: none; box-sizing: border-box; font-family: 'Poppins', sans-serif;
            transition: 0.3s;
        }
        .profile-input:focus { border-color: var(--accent); background: rgba(255,255,255,0.08); }
        
        .btn {
            background: linear-gradient(45deg, var(--accent), var(--accent-hover)); color: #fff; border: none; padding: 14px 24px;
            border-radius: 12px; font-weight: 600; font-size: 14px; cursor: pointer; width: 100%; margin-bottom: 12px;
            transition: all 0.3s ease; text-transform: uppercase; letter-spacing: 1px;
            box-shadow: 0 4px 15px rgba(255, 42, 117, 0.3);
        }
        .btn:hover { transform: translateY(-3px); box-shadow: 0 8px 25px var(--accent-glow); }
        .btn-logout { background: transparent; color: #ff4d4d; border: 1px solid #ff4d4d; box-shadow: none; }
        .btn-logout:hover { background: rgba(255, 77, 77, 0.1); box-shadow: none; transform: translateY(-2px); }

        /* --- HERO --- */
        .hero {
            height: 75vh; position: relative; display: flex; align-items: center; padding: 0 40px;
            background-size: cover; background-position: center top; transition: background-image 1s ease-in-out;
        }
        .hero::after {
            content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(0deg, #0f1014 0%, transparent 80%),
                        linear-gradient(90deg, #0f1014 0%, rgba(15, 16, 20, 0.6) 60%, transparent 100%);
        }
        .hero-content { position: relative; z-index: 2; max-width: 650px; margin-top: 60px; animation: fadeIn 0.8s ease; }
        .hero-title { 
            font-size: 48px; font-weight: 800; margin-bottom: 10px; line-height: 1.1; 
            text-shadow: 2px 4px 15px rgba(0,0,0,0.5);
        }
        .hero-meta { display: flex; gap: 15px; font-size: 14px; margin-bottom: 20px; color: #fff; font-weight: 500; text-shadow: 1px 2px 5px rgba(0,0,0,0.8); align-items: center; }
        .hero-meta span { background: rgba(255,255,255,0.1); padding: 4px 10px; border-radius: 6px; backdrop-filter: blur(5px); }
        .hero-meta span.rating { color: var(--rating-color); font-weight: 800; }
        .hero-desc { 
            font-size: 15px; color: #e0e0e0; display: -webkit-box; 
            -webkit-line-clamp: 3; line-clamp: 3; -webkit-box-orient: vertical; 
            overflow: hidden; line-height: 1.7; text-shadow: 1px 1px 3px rgba(0,0,0,0.8);
        }

        /* --- BRANDS --- */
        .brands-row {
            position: relative; z-index: 5; margin-top: -35px; margin-bottom: 40px;
            padding: 0 20px; display: flex; gap: 12px; 
            justify-content: center; 
            flex-wrap: wrap; 
        }
        .brand-item {
            width: 75px; height: 45px; 
            background: rgba(25, 25, 35, 0.7);
            backdrop-filter: blur(12px); border: 1px solid var(--glass-border);
            border-radius: 12px; display: flex; justify-content: center; align-items: center;
            cursor: pointer; transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); padding: 8px; flex-shrink: 0;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
            position: relative; 
        }
        .brand-item:hover:not(.disabled) { transform: translateY(-4px); background: rgba(255,255,255,0.15); box-shadow: 0 8px 15px rgba(0,0,0,0.4); }
        .brand-item.active { background: rgba(255, 42, 117, 0.2); border-color: var(--accent); box-shadow: 0 5px 20px var(--accent-glow); }
        .brand-item img { max-width: 100%; max-height: 100%; filter: brightness(200%) grayscale(50%); transition: 0.3s; }
        .brand-item:hover:not(.disabled) img, .brand-item.active img { filter: none; }

        .brand-count {
            position: absolute;
            top: -6px; right: -6px;
            background: var(--accent);
            color: #fff;
            font-size: 9px;
            font-weight: 800;
            padding: 2px 5px;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.5);
            z-index: 2;
            letter-spacing: 0;
        }

        .brand-item.disabled { cursor: not-allowed; opacity: 0.6; flex-direction: column; gap: 2px; }
        .brand-item.disabled:hover { box-shadow: 0 4px 10px rgba(0,0,0,0.3); transform: none; }
        .coming-soon-text { font-size: 8px; color: var(--accent); text-transform: uppercase; font-weight: 800; letter-spacing: 0.5px; text-align: center; }

        /* --- CAROUSEL --- */
        .section-container { padding: 0 40px 45px; }
        .section-title { font-size: 20px; margin-bottom: 20px; font-weight: 600; display: flex; align-items: center; gap: 10px; }
        .section-title::before { content: ''; display: block; width: 4px; height: 20px; background: var(--accent); border-radius: 2px; }
        
        .carousel { display: flex; gap: 18px; overflow-x: auto; padding-bottom: 20px; scroll-behavior: smooth; }
        .card {
            min-width: 150px; border-radius: 14px; overflow: hidden;
            cursor: pointer; transition: all 0.3s ease; position: relative;
            border: 1px solid transparent; background: #15161c;
        }
        .card:hover {
            transform: translateY(-8px) scale(1.02);
            border-color: rgba(255, 42, 117, 0.5);
            box-shadow: 0 15px 30px rgba(0,0,0,0.8), 0 0 20px rgba(255, 42, 117, 0.2);
            z-index: 2;
        }
        .card img { width: 100%; height: 225px; object-fit: cover; transition: transform 0.5s ease; }
        .card:hover img { transform: scale(1.08); }
        .card-overlay {
            position: absolute; bottom: 0; width: 100%; padding: 20px 10px 10px;
            background: linear-gradient(transparent, rgba(0,0,0,0.95) 80%);
            box-sizing: border-box; transition: 0.3s;
        }
        .card-title { font-size: 14px; font-weight: 600; text-align: center; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; margin-bottom: 5px; text-shadow: 1px 1px 3px #000; }
        .card-rating { font-size: 12px; color: var(--rating-color); text-align: center; font-weight: 600; text-shadow: 1px 1px 3px #000; }

        /* --- DETAILS & PLAYER --- */
        #details-screen {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: var(--bg-color); z-index: 100; overflow-y: auto; padding: 40px; box-sizing: border-box;
            animation: fadeIn 0.4s ease-out;
        }
        .details-content-wrapper { position: relative; z-index: 2; max-width: 1200px; margin: 0 auto; }
        .details-header { display: flex; flex-direction: column; gap: 35px; margin-bottom: 40px; animation: fadeIn 0.5s ease; }
        .details-poster { width: 220px; border-radius: 16px; align-self: center; box-shadow: 0 20px 40px rgba(0,0,0,0.8); border: 1px solid rgba(255,255,255,0.1); }
        
        .close-details { 
            font-size: 24px; cursor: pointer; position: fixed; right: 30px; top: 30px; z-index: 110; 
            transition: 0.3s; width: 45px; height: 45px; display: flex; align-items: center; justify-content: center;
            background: rgba(0,0,0,0.5); border: 1px solid rgba(255,255,255,0.2); border-radius: 50%; backdrop-filter: blur(10px);
        }
        .close-details:hover { background: var(--accent); border-color: var(--accent); transform: rotate(90deg); }
        
        .meta-tags { display: flex; flex-wrap: wrap; gap: 12px; margin: 15px 0; }
        .tag { background: rgba(255,255,255,0.1); padding: 6px 14px; border-radius: 20px; font-size: 13px; font-weight: 500; backdrop-filter: blur(5px); }
        .tag.rating { background: rgba(255, 215, 0, 0.15); color: var(--rating-color); border: 1px solid rgba(255, 215, 0, 0.3); font-weight: 600;}
        .tag.popularity { background: rgba(255, 69, 0, 0.15); color: #ff6b33; border: 1px solid rgba(255, 69, 0, 0.3); }
        .tag.pro-data { background: rgba(255, 42, 117, 0.15); color: #ff7aa5; border: 1px solid rgba(255, 42, 117, 0.4); }

        .extra-info-text { font-size: 13px; color: #bbb; margin-bottom: 5px; line-height: 1.5; }
        .extra-info-text span { color: #fff; font-weight: 500; }

        .cast-section { margin-bottom: 40px; animation: fadeIn 0.6s ease; }
        .cast-scroll { display: flex; gap: 20px; overflow-x: auto; padding-bottom: 15px; }
        .cast-item { width: 90px; flex-shrink: 0; text-align: center; transition: 0.3s; }
        .cast-item:hover { transform: translateY(-5px); }
        .cast-img { width: 85px; height: 85px; border-radius: 50%; object-fit: cover; border: 2px solid rgba(255,255,255,0.1); margin-bottom: 10px; box-shadow: 0 5px 15px rgba(0,0,0,0.5); }
        .cast-name { font-size: 12px; font-weight: 600; color: white; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; margin-bottom: 2px; }
        .cast-char { font-size: 11px; color: var(--text-sec); overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }

        .episodes-grid { display: grid; grid-template-columns: 1fr; gap: 20px; animation: fadeIn 0.7s ease; }
        .episode-card { 
            background: rgba(20, 21, 28, 0.8); border-radius: 14px; overflow: hidden; display: flex; 
            border: 1px solid rgba(255,255,255,0.05); cursor: pointer; transition: all 0.3s ease; backdrop-filter: blur(10px);
        }
        .episode-card:hover { 
            border-color: var(--accent); background: rgba(255, 42, 117, 0.1); 
            transform: translateX(8px); box-shadow: -8px 8px 20px rgba(0,0,0,0.4);
        }
        .episode-card img { width: 150px; height: 100px; object-fit: cover; }
        
        #player-overlay {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.95); z-index: 200; justify-content: center; align-items: center;
            backdrop-filter: blur(20px); animation: fadeInModal 0.3s ease;
        }
        .iframe-box { width: 100%; height: 100%; box-shadow: 0 0 50px rgba(0,0,0,0.9); }
        .iframe-box iframe { width: 100%; height: 100%; border: none; }

        /* --- FOOTER REDISE√ëADO (NUEVO) --- */
        .main-footer {
            background: rgba(10, 10, 14, 0.8);
            border-top: 1px solid var(--glass-border);
            padding: 25px 40px;
            margin-top: 40px;
            backdrop-filter: blur(10px);
        }
        .footer-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
        }
        .footer-top {
            display: flex;
            align-items: center;
            justify-content: space-between;
            width: 100%;
            flex-wrap: wrap;
            gap: 20px;
        }
        .footer-logo {
            display: flex;
            align-items: center;
            gap: 12px;
            text-decoration: none;
            color: white;
            transition: 0.3s;
        }
        .footer-logo img {
            height: 30px;
            filter: brightness(0) invert(1); /* Logo en blanco */
            opacity: 0.9;
        }
        .footer-logo span {
            font-weight: 800;
            font-size: 18px;
            letter-spacing: -0.5px;
        }
        .footer-logo:hover { opacity: 0.7; }

        .footer-social {
            display: flex;
            align-items: center;
            gap: 10px;
            text-decoration: none;
            color: white;
            background: rgba(255,255,255,0.05);
            padding: 8px 15px;
            border-radius: 20px;
            border: 1px solid var(--glass-border);
            font-size: 13px;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        .footer-social:hover {
            background: radial-gradient(circle at 30% 107%, #fdf497 0%, #fdf497 5%, #fd5949 45%,#d6249f 60%,#285AEB 90%);
            border-color: transparent;
            transform: translateY(-2px);
        }
        .footer-social svg { width: 18px; height: 18px; fill: white; }

        .footer-disclaimer {
            font-size: 11px;
            color: #666;
            text-align: center;
            line-height: 1.6;
            max-width: 800px;
            border-top: 1px solid rgba(255,255,255,0.03);
            padding-top: 15px;
        }

        /* --- RESPONSIVE DESKTOP --- */
        @media (min-width: 768px) {
            nav { padding: 20px 60px; flex-wrap: nowrap; }
            .nav-right { width: auto; gap: 20px; }
            .hero { height: 85vh; padding: 0 80px; }
            .hero-title { font-size: 65px; }
            .hero-desc { -webkit-line-clamp: 4; line-clamp: 4; font-size: 17px; }
            .brands-row { padding: 0 80px; margin-top: -30px; gap: 15px; }
            .brand-item { width: 85px; height: 50px; }
            .section-container { padding: 0 80px 60px; }
            .card { min-width: 190px; }
            .card img { height: 285px; }
            .details-header { flex-direction: row; gap: 50px; align-items: flex-start; }
            .details-poster { width: 280px; position: sticky; top: 40px; }
            .episodes-grid { grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); }
            .episode-card { flex-direction: column; }
            .episode-card img { width: 100%; height: auto; aspect-ratio: 16/9; }
            .iframe-box { width: 85%; height: auto; padding-bottom: 47.81%; position: relative; border-radius: 16px; overflow: hidden; }
            .iframe-box iframe { position: absolute; top: 0; left: 0; }
            .footer-top { flex-direction: row; }
            .footer-disclaimer { font-size: 12px; }
        }
    </style>
</head>
<body>

    <nav>
        <div class="logo-container"><img src="https://i.imgur.com/XAHG8BW.png" onclick="location.reload()"></div>
        <div class="nav-right">
            <div class="user-counter">
                <span class="planet">üåç</span>
                <span id="active-users">0</span> <span style="font-size: 10px; opacity: 0.9; margin-left:-3px;">ACTIVOS</span>
            </div>
            <select id="lang-select" class="lang-select" onchange="changeLanguage()">
                <option value="es-MX">ES</option>
                <option value="en-US">EN</option>
            </select>
            <input type="text" id="search-bar" class="search-input" placeholder="Buscar serie..." oninput="searchSeries()">
            
            <div id="auth-container" class="auth-container">
                <div id="g_id_onload"
                     data-client_id="108165251824-2hqmkr9a0vnvlt4psuuiudeqkv95sgd1.apps.googleusercontent.com"
                     data-callback="handleCredentialResponse"
                     data-auto_prompt="false">
                </div>
                <div class="g_id_signin" data-type="standard" data-shape="pill" data-theme="filled_black" data-text="signin_with" data-size="medium"></div>
            </div>
        </div>
    </nav>

    <div id="profile-modal" class="profile-modal">
        <div class="profile-card">
            <span style="position:absolute; right:25px; top:25px; cursor:pointer; font-size:24px; color: var(--text-sec); transition: 0.3s;" onmouseover="this.style.color='white'" onmouseout="this.style.color='var(--text-sec)'" onclick="closeProfile()">‚úï</span>
            <h3 style="margin-top:0; font-size: 22px; font-weight: 600;">Mi Perfil Pro</h3>
            <img id="profile-preview" src="" alt="Avatar">
            <input type="text" id="profile-name" class="profile-input" placeholder="Tu Nombre">
            <input type="text" id="profile-avatar-url" class="profile-input" placeholder="URL de tu Avatar (opcional)">
            <button class="btn" onclick="saveProfile()">Guardar Cambios</button>
            <button class="btn btn-logout" onclick="logout()">Cerrar Sesi√≥n</button>
        </div>
    </div>

    <div id="hero" class="hero">
        <div class="hero-content">
            <h1 id="hero-title" class="hero-title">ToonCloud+</h1>
            <div id="hero-meta" class="hero-meta"></div>
            <p id="hero-desc" class="hero-desc">Cargando la mejor selecci√≥n de series...</p>
        </div>
    </div>

    <div class="brands-row">
        <div class="brand-item active" onclick="resetFilter(this)">
            <span data-i18n="all" style="font-size: 12px; font-weight: 800; letter-spacing: 1px;">TODOS</span>
            <span class="brand-count" id="cnt-all">0</span>
        </div>
        <div class="brand-item" onclick="filterByNetwork('Cartoon Network', this)">
            <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/8/80/Cartoon_Network_2010_logo.svg/330px-Cartoon_Network_2010_logo.svg.png">
            <span class="brand-count" id="cnt-cn">0</span>
        </div>
        <div class="brand-item" onclick="filterByNetwork('Nickelodeon', this)">
            <img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj33DnGGI7520Upxw725goYhYMR58tKCCuZT47pAZVL2PsKmpiY_HINpmXJoWxQUVavN9EibiI9PTOKwB8j2dMd5ElvGRbekSCApDQOTYes66MQSNGeAdOCMMPsGFDzHeBhXedA1MtQrqb_44Ty_C4loHIdUH4WgppV2ARk0PQ3POo7W2Y35a5y/s370/nicknewlogo.png">
            <span class="brand-count" id="cnt-nick">0</span>
        </div>
        <div class="brand-item" onclick="filterByNetwork('Disney', this)">
            <img src="https://purodiseno.lat/wp-content/uploads/2023/12/LOGO-DISNEY-5-1024x764.png">
            <span class="brand-count" id="cnt-disney">0</span>
        </div>
        <div class="brand-item" onclick="filterByNetwork('Discovery', this)">
            <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/c/c9/Discovery_Kids_2021_2D_Gradient.svg/500px-Discovery_Kids_2021_2D_Gradient.svg.png">
            <span class="brand-count" id="cnt-dk">0</span>
        </div>
        <div class="brand-item disabled" title="Pr√≥ximamente">
            <span style="font-size: 11px; font-weight: 800; letter-spacing: 1px;">ANIME</span>
            <span class="coming-soon-text">Pr√≥ximamente</span>
        </div>
        <div class="brand-item disabled" title="Pr√≥ximamente">
            <span style="font-size: 11px; font-weight: 800; letter-spacing: 1px;">PEL√çCULAS</span>
            <span class="coming-soon-text">Pr√≥ximamente</span>
        </div>
    </div>

    <div id="favorites-section" class="section-container" style="display: none;">
        <h2 class="section-title" data-i18n="my_favorites">Mis Favoritos ‚ù§Ô∏è</h2>
        <div id="favorites-carousel" class="carousel"></div>
    </div>

    <div class="section-container">
        <h2 id="section-title" class="section-title" data-i18n="suggested">Series Sugeridas</h2>
        <div id="carousel" class="carousel"></div>
    </div>

    <footer class="main-footer">
        <div class="footer-container">
            <div class="footer-top">
                <a href="#" class="footer-logo">
                    <img src="https://i.imgur.com/XAHG8BW.png" alt="ToonCloud Logo">
                    <span>ToonCloud+</span>
                </a>
                <a href="https://www.instagram.com/tooncloudtv/" target="_blank" class="footer-social">
                    <svg viewBox="0 0 24 24"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.791-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.209-1.791 4-4 4zm6.406-11.845c.796 0 1.441.645 1.441 1.44s-.645 1.44-1.441 1.44c-.795 0-1.44-.645-1.44-1.44s.645-1.44 1.44-1.44z"/></svg>
                    @tooncloudtv
                </a>
            </div>
            <div class="footer-disclaimer">
                <strong>Descargo de responsabilidad:</strong> ToonCloud+ es un √≠ndice de contenido multimedia. No alojamos, almacenamos ni subimos ning√∫n archivo de video en nuestros servidores. Todo el contenido visualizado es proporcionado por servicios de terceros totalmente ajenos a nosotros. El uso de esta plataforma es responsabilidad del usuario final.
            </div>
        </div>
    </footer>

    <div id="details-screen">
        <span class="close-details" onclick="closeDetails()">‚úï</span>
        
        <div class="details-content-wrapper">
            <div class="details-header">
                <img id="det-poster" class="details-poster" src="">
                <div class="details-info" style="flex: 1;">
                    <h1 id="det-title" style="margin-top:0; font-size: 38px; font-weight: 800; letter-spacing: -0.5px; margin-bottom: 5px; text-shadow: 1px 2px 10px rgba(0,0,0,0.8);"></h1>
                    <h4 id="det-tagline" style="margin-top:0; font-style: italic; color: #ff7aa5; font-weight: 400; font-size: 16px; margin-bottom: 15px;"></h4>
                    
                    <div id="det-meta" class="meta-tags"></div>

                    <div id="det-extra-info" style="margin-bottom: 20px; padding: 15px; background: rgba(0,0,0,0.4); border-radius: 12px; border: 1px solid rgba(255,255,255,0.05); backdrop-filter: blur(5px);">
                        <div class="extra-info-text" id="det-creators"></div>
                        <div class="extra-info-text" id="det-networks"></div>
                        <div class="extra-info-text" id="det-runtime"></div>
                    </div>

                    <p id="det-desc" style="color: #ddd; line-height: 1.7; font-size: 15px; margin-bottom: 30px; max-width: 850px; text-shadow: 1px 1px 3px rgba(0,0,0,0.8);"></p>
                    
                    <div style="display: flex; gap: 15px; align-items: center; margin-bottom: 15px; flex-wrap: wrap;">
                        <select id="season-select" class="lang-select" onchange="loadEpisodes()" style="width: 100%; max-width: 250px; padding: 14px; font-size: 14px; font-weight: 600; background: rgba(255,255,255,0.1); border-color: rgba(255,255,255,0.2);"></select>
                        <button id="fav-btn" class="btn" style="margin-bottom: 0; width: auto; padding: 14px 25px; font-size: 13px;" onclick="toggleFavorite()">‚ù§Ô∏è Guardar en Favoritos</button>
                    </div>
                </div>
            </div>

            <div class="cast-section">
                <h3 class="section-title" data-i18n="cast" style="font-size: 20px; margin-bottom: 20px;">Reparto Principal</h3>
                <div id="cast-list" class="cast-scroll"></div>
            </div>

            <h2 class="section-title" data-i18n="episodes" style="font-size: 24px; margin-bottom: 25px;">Episodios</h2>
            <div id="episodes-list" class="episodes-grid"></div>
        </div>
    </div>

    <div id="player-overlay">
        <div style="position: absolute; top: 25px; right: 30px; font-size: 28px; cursor: pointer; z-index: 210; color: white; transition: 0.3s; width: 50px; height: 50px; display: flex; align-items: center; justify-content: center; background: rgba(255,255,255,0.1); border-radius: 50%; border: 1px solid rgba(255,255,255,0.2);" onmouseover="this.style.background='var(--accent)'; this.style.borderColor='var(--accent)';" onmouseout="this.style.background='rgba(255,255,255,0.1)'; this.style.borderColor='rgba(255,255,255,0.2)';" onclick="closePlayer()">‚úï</div>
        <div class="iframe-box"><iframe id="main-iframe" src="" allowfullscreen></iframe></div>
    </div>

    <script>
        let currentUser = JSON.parse(localStorage.getItem('tooncloud_user')) || null;
        let favoriteShows = JSON.parse(localStorage.getItem('tooncloud_favorites')) || []; 

        function decodeJwtResponse(token) {
            let base64Url = token.split('.')[1];
            let base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
            let jsonPayload = decodeURIComponent(atob(base64).split('').map(function(c) {
                return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
            }).join(''));
            return JSON.parse(jsonPayload);
        }

        function handleCredentialResponse(response) {
            const responsePayload = decodeJwtResponse(response.credential);
            currentUser = { id: responsePayload.sub, name: responsePayload.name, avatar: responsePayload.picture };
            localStorage.setItem('tooncloud_user', JSON.stringify(currentUser));
            updateAuthUI();
        }

        function updateAuthUI() {
            const authContainer = document.getElementById('auth-container');
            if (currentUser) {
                authContainer.innerHTML = `<img src="${currentUser.avatar}" class="nav-avatar" title="${currentUser.name}" onclick="openProfile()">`;
                const heroTitle = document.getElementById('hero-title');
                if(heroTitle.innerText === "ToonCloud+") { heroTitle.innerText = `Hola, ${currentUser.name.split(' ')[0]}`; }
            } else {
                authContainer.innerHTML = `
                    <div id="g_id_onload" data-client_id="108165251824-2hqmkr9a0vnvlt4psuuiudeqkv95sgd1.apps.googleusercontent.com" data-callback="handleCredentialResponse" data-auto_prompt="false"></div>
                    <div class="g_id_signin" data-type="standard" data-shape="pill" data-theme="filled_black" data-text="signin_with" data-size="medium"></div>
                `;
                if(typeof google !== 'undefined') {
                    google.accounts.id.initialize({ client_id: "108165251824-2hqmkr9a0vnvlt4psuuiudeqkv95sgd1.apps.googleusercontent.com", callback: handleCredentialResponse });
                    google.accounts.id.renderButton(authContainer.querySelector('.g_id_signin'), { theme: "filled_black", size: "medium", shape: "pill" });
                }
            }
        }

        function openProfile() {
            if(!currentUser) return;
            document.getElementById('profile-name').value = currentUser.name;
            document.getElementById('profile-avatar-url').value = currentUser.avatar;
            document.getElementById('profile-preview').src = currentUser.avatar;
            document.getElementById('profile-modal').style.display = 'flex';
        }

        function closeProfile() { document.getElementById('profile-modal').style.display = 'none'; }

        function saveProfile() {
            currentUser.name = document.getElementById('profile-name').value || currentUser.name;
            currentUser.avatar = document.getElementById('profile-avatar-url').value || currentUser.avatar;
            localStorage.setItem('tooncloud_user', JSON.stringify(currentUser));
            document.getElementById('profile-preview').src = currentUser.avatar;
            updateAuthUI(); closeProfile();
        }

        function logout() { currentUser = null; localStorage.removeItem('tooncloud_user'); updateAuthUI(); closeProfile(); }

        const TOKEN = 'eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiJhMzZiYmZlMmNiNzdjOWIyNzliOWVkNDc4OWY5NjcxYSIsIm5iZiI6MTc3MDE4OTU4MS4yMTYsInN1YiI6IjY5ODJmMzBkMjM1MmM2MzEzNTM4MzdjNiIsInNjb3BlcyI6WyJhcGlfcmVhZCJdLCJ2ZXJzaW9uIjoxfQ.IEXOBTsDACDo_m6DUt_hqfRvtosp1hLmvv93jNALnKU';
        const IDS = [40075, 387, 4686, 2085, 557, 47035, 6673, 50035, 7736, 1878, 35094, 46759, 18123, 926, 652, 64228, 418, 1068, 8379, 552, 18351, 34891, 2304, 3934, 31499, 234, 2309, 79, 1647, 618, 4627, 17572, 607, 28624, 1769, 346, 17463, 656, 288, 1877, 4630, 33835, 604, 2355, 733, 274382, 897, 4229, 2405, 55924, 47480, 676, 127445, 14705, 9907, 30778, 21086, 94075, 12225, 76004, 32605, 65763, 670, 537, 7821, 3022, 232869, 296764, 126824, 68073, 64228, 12454, 17194, 3022, 504, 384, 588, 657, 2745, 10821, 3579, 1567, 2009, 4630, 2129, 178, 1643, 1848, 1960, 246, 3809, 1346, 3031, 10219, 6046, 3527, 9921, 3854, 15641, 7330, 18352, 5559, 18828, 18848, 33623, 39107, 46358, 46262, 46928, 61520, 46879, 55924, 57532, 60306, 57748, 61330, 61923, 84587, 177, 3611, 606, 4350, 2723, 2660, 4246, 1720, 255, 446, 6618, 10548, 7048, 6040, 15260, 32118, 31109, 33428, 31132, 2641, 679];

        let db = [];
        let currentLang = 'es-MX';
        let selectedShow = null;

        const translations = {
            'es-MX': { all: 'TODOS', suggested: 'Series Sugeridas', search: 'Buscar serie...', episodes: 'Episodios', season: 'Temporada', chapter: 'Cap.', results: 'Resultados: ', cast: 'Reparto Principal', status: 'Estado', my_favorites: 'Mis Favoritos ‚ù§Ô∏è', save_fav: '‚ù§Ô∏è Guardar en Favoritos', remove_fav: 'üíî Quitar de Favoritos', creator: 'Creado por:', networks: 'Cadenas:', runtime: 'Duraci√≥n Ep.:' },
            'en-US': { all: 'ALL', suggested: 'Suggested Series', search: 'Search shows...', episodes: 'Episodes', season: 'Season', chapter: 'Ep.', results: 'Results: ', cast: 'Main Cast', status: 'Status', my_favorites: 'My Favorites ‚ù§Ô∏è', save_fav: '‚ù§Ô∏è Save to Favorites', remove_fav: 'üíî Remove from Favorites', creator: 'Created by:', networks: 'Networks:', runtime: 'Ep. Runtime:' }
        };

        function updateCounter() {
            const weightedNumbers = [0,0,1,1,2,2,3,3,4,4,5,6,7,8];
            document.getElementById('active-users').innerText = weightedNumbers[Math.floor(Math.random() * weightedNumbers.length)];
            setTimeout(updateCounter, Math.floor(Math.random() * (60000 - 20000 + 1)) + 20000);
        }

        function updateNetworkCounts() {
            document.getElementById('cnt-all').innerText = db.length;
            document.getElementById('cnt-cn').innerText = db.filter(s => s.networks.some(n => n.name.toLowerCase().includes('cartoon network'))).length;
            document.getElementById('cnt-nick').innerText = db.filter(s => s.networks.some(n => n.name.toLowerCase().includes('nickelodeon'))).length;
            document.getElementById('cnt-disney').innerText = db.filter(s => s.networks.some(n => n.name.toLowerCase().includes('disney'))).length;
            document.getElementById('cnt-dk').innerText = db.filter(s => s.networks.some(n => n.name.toLowerCase().includes('discovery'))).length;
        }

        async function init() {
            updateAuthUI();
            renderFavorites();
            const fetchs = IDS.map(id => fetch(`https://api.themoviedb.org/3/tv/${id}?language=${currentLang}&append_to_response=credits`, { headers: { Authorization: `Bearer ${TOKEN}` } }).then(r => r.json()));
            db = await Promise.all(fetchs);
            db = db.filter(item => item && item.id);
            updateNetworkCounts();
            updateUI(); setHero(db[Math.floor(Math.random()*db.length)]); renderCarousel(db); updateCounter();
        }

        function updateUI() {
            const t = translations[currentLang];
            document.getElementById('search-bar').placeholder = t.search;
            document.querySelectorAll('[data-i18n]').forEach(el => { if(t[el.getAttribute('data-i18n')]) el.innerText = t[el.getAttribute('data-i18n')]; });
            if(selectedShow) updateFavButtonUI();
        }

        function changeLanguage() { currentLang = document.getElementById('lang-select').value; init(); }

        function renderCarousel(list) {
            document.getElementById('carousel').innerHTML = list.map(s => `
                <div class="card" onclick="openDetails(${s.id})">
                    <img src="${s.poster_path ? 'https://image.tmdb.org/t/p/w342'+s.poster_path : 'https://via.placeholder.com/160x240'}">
                    <div class="card-overlay">
                        <div class="card-title">${s.name}</div>
                        <div class="card-rating">‚≠ê ${s.vote_average ? s.vote_average.toFixed(1) : 'N/A'}</div>
                    </div>
                </div>
            `).join('');
        }

        function renderFavorites() {
            const favSection = document.getElementById('favorites-section');
            const favCarousel = document.getElementById('favorites-carousel');
            if (favoriteShows.length === 0) {
                favSection.style.display = 'none';
            } else {
                favSection.style.display = 'block';
                favCarousel.innerHTML = favoriteShows.map(s => `
                    <div class="card" onclick="openDetails(${s.id})">
                        <img src="${s.poster_path ? 'https://image.tmdb.org/t/p/w342'+s.poster_path : 'https://via.placeholder.com/160x240'}">
                        <div class="card-overlay">
                            <div class="card-title">${s.name}</div>
                            <div class="card-rating">‚≠ê ${s.vote_average ? s.vote_average.toFixed(1) : 'N/A'}</div>
                        </div>
                    </div>
                `).join('');
            }
        }

        function toggleFavorite() {
            if (!selectedShow) return;
            const index = favoriteShows.findIndex(f => f.id === selectedShow.id);
            if (index > -1) { favoriteShows.splice(index, 1); } 
            else { favoriteShows.unshift(selectedShow); }
            localStorage.setItem('tooncloud_favorites', JSON.stringify(favoriteShows));
            updateFavButtonUI(); renderFavorites();
        }

        function updateFavButtonUI() {
            const btn = document.getElementById('fav-btn');
            const isFav = favoriteShows.some(f => f.id === selectedShow.id);
            const t = translations[currentLang];
            if (isFav) {
                btn.innerHTML = t.remove_fav;
                btn.style.background = 'transparent';
                btn.style.border = '2px solid var(--accent)';
                btn.style.color = 'var(--accent)';
            } else {
                btn.innerHTML = t.save_fav;
                btn.style.background = 'linear-gradient(45deg, var(--accent), var(--accent-hover))';
                btn.style.border = 'none';
                btn.style.color = '#fff';
            }
        }

        function searchSeries() {
            const query = document.getElementById('search-bar').value.toLowerCase();
            document.getElementById('section-title').innerText = query ? translations[currentLang].results + query : translations[currentLang].suggested;
            renderCarousel(db.filter(s => s.name.toLowerCase().includes(query)));
        }

        function setHero(s) {
            if(!s) return;
            document.getElementById('hero').style.backgroundImage = `url(https://image.tmdb.org/t/p/original${s.backdrop_path})`;
            document.getElementById('hero-title').innerText = currentUser ? `Hola, ${currentUser.name.split(' ')[0]}` : s.name;
            document.getElementById('hero-desc').innerText = s.overview || "";
            document.getElementById('hero-meta').innerHTML = `
                <span class="rating">‚≠ê ${s.vote_average ? s.vote_average.toFixed(1) : ''}</span>
                <span>${s.first_air_date ? s.first_air_date.split('-')[0] : ''}</span>
                <span>${s.number_of_seasons ? s.number_of_seasons + ' T.' : ''}</span>
            `;
        }

        async function openDetails(id) {
            selectedShow = db.find(s => s.id == id) || favoriteShows.find(s => s.id == id);
            const t = translations[currentLang];
            const detailsScreen = document.getElementById('details-screen');
            if(selectedShow.backdrop_path) {
                detailsScreen.style.backgroundImage = `linear-gradient(rgba(15, 16, 20, 0.92), rgba(15, 16, 20, 1) 70%), url(https://image.tmdb.org/t/p/original${selectedShow.backdrop_path})`;
                detailsScreen.style.backgroundSize = 'cover';
                detailsScreen.style.backgroundPosition = 'center top';
                detailsScreen.style.backgroundAttachment = 'fixed';
            } else { detailsScreen.style.backgroundImage = 'none'; }

            document.getElementById('det-title').innerText = selectedShow.name;
            document.getElementById('det-tagline').innerText = selectedShow.tagline ? `"${selectedShow.tagline}"` : '';
            document.getElementById('det-desc').innerText = selectedShow.overview || 'Sin descripci√≥n disponible.';
            document.getElementById('det-poster').src = selectedShow.poster_path ? `https://image.tmdb.org/t/p/w500${selectedShow.poster_path}` : 'https://via.placeholder.com/500x750';
            updateFavButtonUI(); 

            const creators = selectedShow.created_by && selectedShow.created_by.length > 0 ? selectedShow.created_by.map(c => c.name).join(', ') : 'Desconocido';
            const networks = selectedShow.networks ? selectedShow.networks.map(n => n.name).join(', ') : 'N/A';
            const runTime = selectedShow.episode_run_time && selectedShow.episode_run_time.length > 0 ? `${selectedShow.episode_run_time[0]} min` : 'N/A';
            document.getElementById('det-creators').innerHTML = `${t.creator} <span>${creators}</span>`;
            document.getElementById('det-networks').innerHTML = `${t.networks} <span>${networks}</span>`;
            document.getElementById('det-runtime').innerHTML = `${t.runtime} <span>${runTime}</span>`;

            const year = selectedShow.first_air_date ? selectedShow.first_air_date.split('-')[0] : 'N/A';
            const genres = selectedShow.genres ? selectedShow.genres.slice(0,3).map(g => g.name).join(', ') : '';
            const status = selectedShow.in_production ? "En Emisi√≥n" : "Finalizada";
            const isHot = Math.round(selectedShow.popularity) > 800 ? 'üî•' : '';
            const totalEps = selectedShow.number_of_episodes ? `${selectedShow.number_of_episodes} Eps Totales` : '';
            const lang = selectedShow.original_language ? selectedShow.original_language.toUpperCase() : '';

            document.getElementById('det-meta').innerHTML = `
                <span class="tag rating">‚≠ê ${selectedShow.vote_average.toFixed(1)}</span>
                <span class="tag popularity">${isHot} Pop: ${Math.round(selectedShow.popularity)}</span>
                <span class="tag pro-data">${totalEps}</span>
                <span class="tag pro-data">${lang}</span>
                <span class="tag" style="background: rgba(255,255,255,0.05);">${year}</span>
                <span class="tag" style="background: rgba(255,255,255,0.05);">${status}</span>
                <span class="tag" style="border:1px solid var(--glass-border); background: transparent;">${genres}</span>
            `;

            const castContainer = document.getElementById('cast-list');
            if (selectedShow.credits && selectedShow.credits.cast && selectedShow.credits.cast.length > 0) {
                castContainer.innerHTML = selectedShow.credits.cast.slice(0, 12).map(actor => `
                    <div class="cast-item">
                        <img class="cast-img" src="${actor.profile_path ? 'https://image.tmdb.org/t/p/w185'+actor.profile_path : 'https://via.placeholder.com/100?text=No+Img'}">
                        <div class="cast-name">${actor.name}</div>
                        <div class="cast-char">${actor.character}</div>
                    </div>
                `).join('');
                document.querySelector('.cast-section').style.display = 'block';
            } else { document.querySelector('.cast-section').style.display = 'none'; }

            const select = document.getElementById('season-select');
            select.innerHTML = selectedShow.seasons.filter(se => se.season_number > 0).map(se => `<option value="${se.season_number}">${t.season} ${se.season_number}</option>`).join('');

            document.getElementById('details-screen').style.display = 'block'; document.body.style.overflow = 'hidden';
            if(select.options.length > 0) loadEpisodes(); else document.getElementById('episodes-list').innerHTML = '<div style="padding:20px; color:#666;">No hay episodios disponibles.</div>';
        }

        async function loadEpisodes() {
            const seasonNum = document.getElementById('season-select').value;
            if(!seasonNum) return;
            const res = await fetch(`https://api.themoviedb.org/3/tv/${selectedShow.id}/season/${seasonNum}?language=${currentLang}`, { headers: { Authorization: `Bearer ${TOKEN}` } });
            const data = await res.json();
            
            if(data.episodes) {
                document.getElementById('episodes-list').innerHTML = data.episodes.map(ep => `
                    <div class="episode-card" onclick="playEpisode(${seasonNum}, ${ep.episode_number})">
                        <img src="${ep.still_path ? 'https://image.tmdb.org/t/p/w300'+ep.still_path : 'https://via.placeholder.com/300x169?text=Sin+Imagen'}">
                        <div style="padding:15px; display:flex; flex-direction:column; justify-content:center; flex:1">
                            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom: 8px;">
                                <span style="color:var(--accent); font-size:13px; font-weight:800; letter-spacing: 0.5px;">${translations[currentLang].chapter} ${ep.episode_number}</span>
                                <span style="font-size:12px; color:#aaa; font-weight:600; background:rgba(0,0,0,0.5); padding:2px 6px; border-radius:4px;">‚≠ê ${ep.vote_average ? ep.vote_average.toFixed(1) : '-'}</span>
                            </div>
                            <div style="font-size:15px; line-height:1.3; font-weight:600; color:#fff;">${ep.name}</div>
                            <div style="font-size:12px; color:#999; margin-top:8px; display: -webkit-box; -webkit-line-clamp: 2; line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; line-height: 1.5;">${ep.overview || 'Sin sinopsis.'}</div>
                        </div>
                    </div>
                `).join('');
            }
        }

        function playEpisode(s, e) {
            document.getElementById('main-iframe').src = `https://www.vidking.net/embed/tv/${selectedShow.id}/${s}/${e}?color=ff2a75&autoPlay=true&nextEpisode=true&episodeSelector=true`;
            document.getElementById('player-overlay').style.display = 'flex';
        }

        function closeDetails() { document.getElementById('details-screen').style.display = 'none'; document.body.style.overflow = 'auto'; }
        function closePlayer() { document.getElementById('player-overlay').style.display = 'none'; document.getElementById('main-iframe').src = ""; }
        
        function filterByNetwork(name, el) {
            document.querySelectorAll('.brand-item').forEach(b => b.classList.remove('active')); el.classList.add('active');
            renderCarousel(db.filter(s => s.networks.some(n => n.name.toLowerCase().includes(name.toLowerCase()))));
        }

        function resetFilter(el) { document.querySelectorAll('.brand-item').forEach(b => b.classList.remove('active')); el.classList.add('active'); renderCarousel(db); }

        init();
    </script>
</body>
</html>
